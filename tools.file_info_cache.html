

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>lasif.tools.file_info_cache &mdash; LASIF 0.1.x documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="LASIF 0.1.x documentation" href="index.html"/>
        <link rel="up" title="API Documentation" href="api_doc.html"/>
        <link rel="next" title="API Components" href="components/components.html"/>
        <link rel="prev" title="lasif.tools.parallel" href="tools.parallel.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> LASIF
          

          
          </a>

          
            
            
              <div class="version">
                0.1.x
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="prerequisites.html">Installation, Testing &amp; DevInfo</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">Command Line Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="webinterface.html">Web Interface</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="api_doc.html">API Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="iris2quakeml.html">lasif.scripts.iris2quakeml</a></li>
<li class="toctree-l2"><a class="reference internal" href="ses3d_setup_helper.html">SES3D Setup Assistant</a></li>
<li class="toctree-l2"><a class="reference internal" href="iteration_xml.html">lasif.iteration_xml</a></li>
<li class="toctree-l2"><a class="reference internal" href="rotations.html">lasif.rotations</a></li>
<li class="toctree-l2"><a class="reference internal" href="window_selection.html">lasif.window_selection</a></li>
<li class="toctree-l2"><a class="reference internal" href="tools.html">lasif.tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="tools.parallel.html">lasif.tools.parallel</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">lasif.tools.file_info_cache</a></li>
<li class="toctree-l2"><a class="reference internal" href="components/components.html">API Components</a></li>
<li class="toctree-l2"><a class="reference internal" href="how_lasif_finds_coordinates.html">How LASIF Finds Coordinates</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">LASIF</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="api_doc.html">API Documentation</a> &raquo;</li>
        
      <li>lasif.tools.file_info_cache</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/tools.file_info_cache.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-lasif.tools.cache_helpers.file_info_cache">
<span id="lasif-tools-file-info-cache"></span><h1>lasif.tools.file_info_cache<a class="headerlink" href="#module-lasif.tools.cache_helpers.file_info_cache" title="Permalink to this headline">Â¶</a></h1>
<p>A file info cache class. Must be subclassed.</p>
<p>The cache is able to monitor a bunch of (arbitrary) files and store some
indexes information about each file. This is useful for keeping track of a
large number of files and what is in them.</p>
<p>To subclass it you need to provide the values you want to index, the types of
files you want to index and functions to extract the indices and find the
files. Upon each call to the constructor it will check the existing database,
automatically remove any deleted files, reindex modified ones and add new ones.</p>
<p>This is much faster then reading the files every time but still provides a lot
of flexibility as the data can be managed by some other means.</p>
<p>Example implementation:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ImageCache</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image_folder</span><span class="p">,</span> <span class="n">cache_db_file</span><span class="p">):</span>
        <span class="c1"># The index values are a list of tuples. The first denotes the</span>
        <span class="c1"># name of the index and the second the type of the index. The types</span>
        <span class="c1"># have to correspond to SQLite types.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index_values</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="s2">&quot;width&quot;</span><span class="p">,</span> <span class="s2">&quot;INTEGER&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;height&quot;</span><span class="p">,</span> <span class="s2">&quot;INTEGER&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="s2">&quot;TEXT&quot;</span><span class="p">)]</span>
        <span class="c1"># The types of files to index.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filetypes</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;png&quot;</span><span class="p">,</span> <span class="s2">&quot;jpeg&quot;</span><span class="p">]</span>

        <span class="c1"># Subclass specific values</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">image_folder</span> <span class="o">=</span> <span class="n">image_folder</span>

        <span class="c1"># Don&#39;t forget to call the parents __init__()!</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ImageCache</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">cache_db_file</span><span class="o">=</span><span class="n">cache_db_file</span><span class="p">)</span>

    <span class="c1"># Now you need to define one &#39;find files&#39; and one &#39;index file&#39;</span>
    <span class="c1"># methods for each filetype. The &#39;find files&#39; method needs to be named</span>
    <span class="c1"># &#39;_find_files_FILETYPE&#39; and takes no arguments. The &#39;index file&#39;</span>
    <span class="c1"># method has to be named &#39;_extract_index_values_FILETYPE&#39; and takes one</span>
    <span class="c1"># argument: the path to file. It needs to return a list of lists. Each</span>
    <span class="c1"># inner list contains the indexed values in the same order as specified</span>
    <span class="c1"># in self.index_values. It can return multiple sets of indices per</span>
    <span class="c1"># file. Useful for lots of filetypes, not necessarily images as in the</span>
    <span class="c1"># example here.</span>

    <span class="k">def</span> <span class="nf">_find_files_png</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;*.png&quot;</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_find_files_jpeg</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;*.png&quot;</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_extract_index_values_png</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
        <span class="c1"># Do somethings to get the values.</span>
        <span class="k">return</span> <span class="p">[[</span><span class="mi">400</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="s2">&quot;png&quot;</span><span class="p">]]</span>

    <span class="k">def</span> <span class="nf">_extract_index_values_jpeg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
        <span class="c1"># Do somethings to get the values.</span>
        <span class="k">return</span> <span class="p">[[</span><span class="mi">400</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="s2">&quot;jpeg&quot;</span><span class="p">]]</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">copyright:</th><td class="field-body">Lion Krischer (<a class="reference external" href="mailto:krischer&#37;&#52;&#48;geophysik&#46;uni-muenchen&#46;de">krischer<span>&#64;</span>geophysik<span>&#46;</span>uni-muenchen<span>&#46;</span>de</a>), 2013</td>
</tr>
<tr class="field-even field"><th class="field-name">license:</th><td class="field-body">GNU General Public License, Version 3
(<a class="reference external" href="http://www.gnu.org/copyleft/gpl.html">http://www.gnu.org/copyleft/gpl.html</a>)</td>
</tr>
</tbody>
</table>
<dl class="class">
<dt id="lasif.tools.cache_helpers.file_info_cache.FileInfoCache">
<em class="property">class </em><code class="descclassname">lasif.tools.cache_helpers.file_info_cache.</code><code class="descname">FileInfoCache</code><span class="sig-paren">(</span><em>cache_db_file</em>, <em>root_folder</em>, <em>read_only</em>, <em>pretty_name</em>, <em>show_progress=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lasif/tools/cache_helpers/file_info_cache.html#FileInfoCache"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lasif.tools.cache_helpers.file_info_cache.FileInfoCache" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Object able to cache information about arbitrary files on the filesystem.</p>
<p>Intended to be subclassed.</p>
<dl class="attribute">
<dt id="lasif.tools.cache_helpers.file_info_cache.FileInfoCache.file_count">
<code class="descname">file_count</code><a class="headerlink" href="#lasif.tools.cache_helpers.file_info_cache.FileInfoCache.file_count" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns number of files.</p>
</dd></dl>

<dl class="method">
<dt id="lasif.tools.cache_helpers.file_info_cache.FileInfoCache.get_details">
<code class="descname">get_details</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lasif/tools/cache_helpers/file_info_cache.html#FileInfoCache.get_details"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lasif.tools.cache_helpers.file_info_cache.FileInfoCache.get_details" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Get the indexed information about one file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filename</strong> â The filename for which to request information.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="lasif.tools.cache_helpers.file_info_cache.FileInfoCache.get_values">
<code class="descname">get_values</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lasif/tools/cache_helpers/file_info_cache.html#FileInfoCache.get_values"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lasif.tools.cache_helpers.file_info_cache.FileInfoCache.get_values" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns a list of dictionaries containing all indexed values for every
file together with the filename.</p>
</dd></dl>

<dl class="attribute">
<dt id="lasif.tools.cache_helpers.file_info_cache.FileInfoCache.index_count">
<code class="descname">index_count</code><a class="headerlink" href="#lasif.tools.cache_helpers.file_info_cache.FileInfoCache.index_count" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns number of indices.</p>
</dd></dl>

<dl class="attribute">
<dt id="lasif.tools.cache_helpers.file_info_cache.FileInfoCache.total_size">
<code class="descname">total_size</code><a class="headerlink" href="#lasif.tools.cache_helpers.file_info_cache.FileInfoCache.total_size" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the total file size in bytes.</p>
</dd></dl>

<dl class="method">
<dt id="lasif.tools.cache_helpers.file_info_cache.FileInfoCache.update">
<code class="descname">update</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lasif/tools/cache_helpers/file_info_cache.html#FileInfoCache.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lasif.tools.cache_helpers.file_info_cache.FileInfoCache.update" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Updates the database.</p>
</dd></dl>

</dd></dl>

</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="components/components.html" class="btn btn-neutral float-right" title="API Components" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="tools.parallel.html" class="btn btn-neutral" title="lasif.tools.parallel" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Lion Krischer &amp; Andreas Fichtner.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.1.x',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>